In order to optimize the exponents and coefficients of basis sets we are employing differentiable integrals in order to use automatic differentiation and gradient decent to optimize the basis sets. Most commonly used integral implentations like \cite{libxc} or \cite{orca} are implemented in c++ as the computation of the integrals using the previously introduced recursion relations involves many loops and is computationally expensive as the integrals have to be computed for every combination of shells from every atom with each other. This would make the integrals also very computationally expensive if one would store all recursions in memory at at given time. This is why efficient integral libraries delete or override temporary variables when they are not longer usefull. But this makes it also impossible to use automatic differentiation as they rely on building a complete computational graph through which the gradients can be backpropagated. In order to obtain a differentiable integral computation framework we started with the much less optimized python library for chemical integrals \cite{gbasis}. Their entire framework was build upon the numerical computation package for python \cite{numpy}, which could easily be replaced by the popular machine learning framework pytorch\cite{pytorch}. As pytorch implements automatic differentiation and gradient decent it is possible to compute the integrals in a differentiable way if all parts of the calculation are done using pytorch. Unfortually these integrals were not very efficient as they involved a large number of operations and lead to an very complicated computational graph.

\subsection{Optimisation of the integrals}
The native integral implementation of gbasis involved treating every exponent of a ... as a separate variable and computing the integrals for every combination of them individually. This could be improved by treating all exponents and coefficients of a shell as a single PAo which lets us define them as a single torch Tensor object. As another optimisation procedere all combinations of shells which happend to have the same number of dimentions, so for example in a two center integral all combinations of shells with angular momentum 0 with all possible partners of anglar momentum 1, were concatenated , such that all these integrals could be computed in a single step. This reduces the amount of torch calculations drasticly and lowers the complexity of the resulting computational graph.
Still after these improvements the standart libraries were still orders of magnitudes faster, even when deploying the integrals on gpu.